"use strict";(self.webpackChunksqliste_doc=self.webpackChunksqliste_doc||[]).push([[9442],{9868:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>f});var r=t(6687);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(t),c=a,f=m["".concat(l,".").concat(c)]||m[c]||d[c]||o;return t?r.createElement(f,i(i({ref:n},u),{},{components:t})):r.createElement(f,i({ref:n},u))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=c;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[m]="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},7630:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=t(8792),a=(t(6687),t(9868));const o={sidebar_position:3},i="D\xe9finir un contr\xf4leur",s={unversionedId:"intregrations/sql-server/define-controller",id:"intregrations/sql-server/define-controller",title:"D\xe9finir un contr\xf4leur",description:"Un contr\xf4leur prend la forme d'une proc\xe9dure stock\xe9e situ\xe9e dans le sch\xe9ma web.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/intregrations/sql-server/define-controller.md",sourceDirName:"intregrations/sql-server",slug:"/intregrations/sql-server/define-controller",permalink:"/sqliste/fr/docs/intregrations/sql-server/define-controller",draft:!1,editUrl:"https://github.com/corentin703/sqliste/tree/main/doc/docs/intregrations/sql-server/define-controller.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docSidebar",previous:{title:"Structure",permalink:"/sqliste/fr/docs/intregrations/sql-server/structure"},next:{title:"D\xe9finir un intergiciel",permalink:"/sqliste/fr/docs/intregrations/sql-server/define-middleware"}},l={},p=[{value:"Param\xe8tres d&#39;URI",id:"param\xe8tres-duri",level:2},{value:"Param\xe8tres de route",id:"param\xe8tres-de-route",level:2},{value:"Consommer le corp d&#39;une requ\xeate",id:"consommer-le-corp-dune-requ\xeate",level:2},{value:"Consommer un formulaire",id:"consommer-un-formulaire",level:2},{value:"R\xe9cup\xe9rer un fichier",id:"r\xe9cup\xe9rer-un-fichier",level:3},{value:"T\xe9l\xe9chargement de fichiers",id:"t\xe9l\xe9chargement-de-fichiers",level:2}],u={toc:p},m="wrapper";function d(e){let{components:n,...t}=e;return(0,a.kt)(m,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"d\xe9finir-un-contr\xf4leur"},"D\xe9finir un contr\xf4leur"),(0,a.kt)("p",null,"Un contr\xf4leur prend la forme d'une proc\xe9dure stock\xe9e situ\xe9e dans le sch\xe9ma ",(0,a.kt)("em",{parentName:"p"},"web"),"."),(0,a.kt)("p",null,"Voici un exemple de contr\xf4leur basique :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- #Route(\"/api/helloWorld\")\n-- #HttpGet(\"HelloWorld\")\nCREATE OR ALTER PROCEDURE [web].[p_hello_world] \nAS \nBEGIN\n    SELECT \n         'Salutation tout le beau monde !' AS [response_body] -- On retourne le corp de la r\xe9ponse\n        ,'text/plain' AS [response_content_type] -- Le type MIME du corp\n        ,200 AS [response_status] -- Le statut HTTP de la r\xe9ponse\n    ;\nEND\nGO\n")),(0,a.kt)("h2",{id:"param\xe8tres-duri"},"Param\xe8tres d'URI"),(0,a.kt)("p",null,"Un param\xe8tre d'URI est un argument fourni comme suit dans un URI : ",(0,a.kt)("inlineCode",{parentName:"p"},"/api/exemple?name=Corentin"),(0,a.kt)("br",null),"\nPour en r\xe9cup\xe9rer la valeur, il suffit de le prendre en argument de proc\xe9dure :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- On d\xe9fini le param\xe8tre 'name' dans la route entre accolades\n-- #Route(\"/api/helloWorld\")\n-- #HttpGet(\"HelloWorld\")\nCREATE OR ALTER PROCEDURE [web].[p_hello_world] \n    @name NVARCHAR(100) = NULL -- On r\xe9cup\xe8re le param\xe8tre d'URI 'name'\nAS \nBEGIN\n    DECLARE @response_body NVARCHAR(MAX);\n    \n    IF (@name IS NULL)\n        SET @response_body = 'Salutation tout le beau monde !';\n    ELSE    \n        SELECT @response_body = 'Salutation ' + @name + ' !';\n\n    SELECT \n         @response_body AS [response_body]\n        ,'text/plain' AS [response_content_type]\n        ,200 AS [response_status]\n    ;\nEND\nGO\n")),(0,a.kt)("p",null,"Un param\xe8tre d'URI est toujours consid\xe9r\xe9 comme \xe9tant facultatif, et doit \xeatre de type NVARCHAR (charge \xe0 la proc\xe9dure de le caster si un autre type est attendu)."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Il est recommand\xe9 de d\xe9finir une valeur par d\xe9faut pour les param\xe8tres d'URI, ainsi que pour les param\xe8tres de route facultatifs dans les arguments de proc\xe9dure :\ns'il n'y en a pas et que le param\xe8tre n'est pas fourni, le SGBD ne pourra pas ex\xe9cuter la proc\xe9dure et remontera une erreur.")),(0,a.kt)("h2",{id:"param\xe8tres-de-route"},"Param\xe8tres de route"),(0,a.kt)("p",null,"Comme la plupart des ",(0,a.kt)("em",{parentName:"p"},"frameworks")," web, SQListe permet de d\xe9finir des mod\xe8les de route.\nCela permet de passer des arguments directement dans la route plut\xf4t que dans les param\xe8tres d'URI, ou encore dans le corp de la requ\xeate."),(0,a.kt)("p",null,"Exemple :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- On d\xe9fini le param\xe8tre 'name' dans la route entre accolades\n-- #Route(\"/api/helloWorld/{name}\")\n-- #HttpGet(\"HelloWorld\")\nCREATE OR ALTER PROCEDURE [web].[p_hello_world] \n    @name NVARCHAR(100) -- On r\xe9cup\xe8re le param\xe8tre avec le m\xeame nom en argument de proc\xe9dure\nAS \nBEGIN\n    DECLARE @response_body NVARCHAR(MAX);\n    \n    SELECT @response_body = 'Salutation ' + @name + ' !';\n\n    SELECT \n         @response_body AS [response_body]\n        ,'text/plain' AS [response_content_type]\n        ,200 AS [response_status]\n    ;\nEND\nGO\n")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Il est tout \xe0 fait possible de d\xe9finir plusieurs param\xe8tres dans la route, avec un nom diff\xe9rent."),(0,a.kt)("p",{parentName:"admonition"},"Comme pour les param\xe8tres d'URI, les param\xe8tres de route seront inject\xe9s avec le type NVARCHAR.")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Si un nom de param\xe8tre est identique \xe0 un nom de param\xe8tre standard, ce dernier prendra le dessus. ")),(0,a.kt)("p",null,"Dans notre exemple ci-dessus, le param\xe8tre est consid\xe9r\xe9 comme requis : s'il n'est pas fourni, SQListe ne fera pas la correspondance avec cette route.",(0,a.kt)("br",null),"\nPour d\xe9finir un param\xe8tre optionnel, nous pouvons faire comme suit :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- On d\xe9fini le param\xe8tre 'name' dans la route entre accolades\n-- #Route(\"/api/helloWorld/{name?}\")\n-- #HttpGet(\"HelloWorld\")\nCREATE OR ALTER PROCEDURE [web].[p_hello_world] \n    @name NVARCHAR(100) = NULL -- On r\xe9cup\xe8re le param\xe8tre avec le m\xeame nom en argument de proc\xe9dure, en mettant une valeur NULL par d\xe9faut (utile si le param\xe8tre n'est pas fourni).\nAS \nBEGIN\n    DECLARE @response_body NVARCHAR(MAX);\n    \n    IF (@name IS NULL)\n        SET @response_body = 'Salutation tout le monde !';\n    ELSE    \n        SELECT @response_body = 'Salutation ' + @name + ' !';\n\n    SELECT \n         @response_body AS [response_body]\n        ,'text/plain' AS [response_content_type]\n        ,200 AS [response_status]\n    ;\nEND\nGO\n")),(0,a.kt)("p",null,"Un param\xe8tre facultatif ",(0,a.kt)("strong",{parentName:"p"},"doit")," figurer en fin de route.\nExemple : "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/api/say/hello/{name?}/{age?}")," => Valide."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/api/say/hello/{name}/withAge/{age?}")," => Valide."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"/api/say/hello/{name?}/withAge/{age?}")," => Invalide : le bon fonctionnement ne sera pas garanti.")),(0,a.kt)("p",null,"Lorsque l'on a plusieurs param\xe8tres facultatifs, il vaut souvent mieux utiliser des param\xe8tres d'URI, comme d\xe9crit pr\xe9c\xe9demment."),(0,a.kt)("admonition",{title:"Limitations",type:"warning"},(0,a.kt)("p",{parentName:"admonition"},"La taille d'un URI \xe9tant limit\xe9e \xe0 maximum 2048 caract\xe8res, des probl\xe8mes de lecture peuvent survenir en cas de param\xe8tres trop longs."),(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("em",{parentName:"p"},"Certains serveurs permettent d'augmenter cette limite, cependant il convient de v\xe9rifier que le client HTTP / navigateur prenne cette augmentation en charge."))),(0,a.kt)("h2",{id:"consommer-le-corp-dune-requ\xeate"},"Consommer le corp d'une requ\xeate"),(0,a.kt)("p",null,"Vous pouvez r\xe9cup\xe9rer les donn\xe9es envoy\xe9es comme ceci gr\xe2ce au param\xe8tre standard ",(0,a.kt)("em",{parentName:"p"},"request_body"),".",(0,a.kt)("br",null),"\nLe format de cet \xe9l\xe9ment est libre et doit correspondre au ",(0,a.kt)("em",{parentName:"p"},"Content-Type")," renseign\xe9 dans l'en-t\xeate de la requ\xeate."),(0,a.kt)("p",null,"Prenons l'exemple d'une requ\xeate sur une route permettant l'authentification d'un utilisateur, ou nous avons besoin de\nr\xe9cup\xe9rer le courriel de l'utilisateur, ainsi que son mot de passe :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- #Route(\"/api/account/login\")\n-- #HttpPost(\"AccountLogin\")\nCREATE OR ALTER PROCEDURE [web].[p_account_login] \n    @request_body NVARCHAR(MAX), -- Les informations saisies par l'utilisateur seront stock\xe9es ici\n    @request_content_type NVARCHAR(255)\nAS \nBEGIN\n    IF (@request_content_type <> 'application/json')\n    BEGIN\n        SELECT \n            ,@request_content_type AS [response_content_type]\n            ,415 AS [response_status] -- 415 = Unsupported Media Type\n        ;\n        RETURN;   \n    END\n    \n    DECLARE @email NVARCHAR(1000);\n    DECLARE @password NVARCHAR(1000);\n    \n    SELECT \n         @email = [email]\n        ,@password = [password]\n    FOR OPENJSON(@request_body)\n    WITH (\n         [email] NVARCHAR(1000)\n        ,[password] NVARCHAR(1000)\n    );\n    \n    IF (@email = 'example@email.com' AND @password = 'SuperPa$$word!!!')\n    BEGIN\n        SELECT \n             '{ \"message\": \"Vous \xeates connect\xe9 !\" }' AS [response_body]\n            ,'application/json' AS [response_content_type]\n            ,200 AS [response_status]\n        ;\n    END\n    ELSE    \n    BEGIN\n        SELECT \n             '{ \"message\": \"Une erreur est survenue durant la connexion\" }' AS [response_body]\n            ,'application/json' AS [response_content_type]\n            ,401 AS [response_status]\n        ;\n    END\nEND\nGO\n")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Un corp de requ\xeate ne peut pas \xeatre joint \xe0 une requ\xeate ",(0,a.kt)("em",{parentName:"p"},"GET")," ou ",(0,a.kt)("em",{parentName:"p"},"HEAD"),".",(0,a.kt)("br",null),"\n",(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Request/body"},"Pour en savoir plus"),".")),(0,a.kt)("h2",{id:"consommer-un-formulaire"},"Consommer un formulaire"),(0,a.kt)("p",null,"Certains ",(0,a.kt)("em",{parentName:"p"},"Content-Type")," servent \xe0 mat\xe9rialiser un formulaire (notamment pour la balise ",(0,a.kt)("inlineCode",{parentName:"p"},"<form />")," en html).\nDans ces cas-l\xe0, le ",(0,a.kt)("em",{parentName:"p"},"Content-Type")," vaudra soit ",(0,a.kt)("inlineCode",{parentName:"p"},"application/x-www-form-urlencoded")," soit ",(0,a.kt)("inlineCode",{parentName:"p"},"multipart/form-data"),"."),(0,a.kt)("p",null,"Lorsqu'une requ\xeate de ce type est transmise \xe0 SQListe, celui-ci ne va pas injecter ses donn\xe9es dans le param\xe8tre\n",(0,a.kt)("em",{parentName:"p"},"request_body"),", mais dans le param\xe8tre ",(0,a.kt)("em",{parentName:"p"},"request_form"),"."),(0,a.kt)("p",null,"Le contenu de ce param\xe8tre sera un JSON de ce format-l\xe0 :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json",metastring:"lines",lines:!0},'[\n  {\n    "name": "nom du champ",\n    "value": "valeur du champ" // Toujours de type string\n  },\n  {\n    "name": "nom du 2nd champ",\n    "value": "valeur du 2nd champ" // Toujours de type string\n  },\n  // ...\n]\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Lorsque le param\xe8tre ",(0,a.kt)("em",{parentName:"p"},"request_form")," n'est pas \xe9gal \xe0 ",(0,a.kt)("em",{parentName:"p"},"NULL"),", le param\xe8tre ",(0,a.kt)("em",{parentName:"p"},"request_body")," l'est.")),(0,a.kt)("h3",{id:"r\xe9cup\xe9rer-un-fichier"},"R\xe9cup\xe9rer un fichier"),(0,a.kt)("p",null,"Les requ\xeates de type ",(0,a.kt)("em",{parentName:"p"},"form"),", permettent d'envoyer directement des fichiers sans encodage particulier (tel que le base64).",(0,a.kt)("br",null),"\nLorsqu'un \xe9l\xe9ment correspond \xe0 un fichier, SQListe va injecter un objet JSON au format ci-dessous dans le param\xe8tre ",(0,a.kt)("em",{parentName:"p"},"request_form")," pour le champ concern\xe9."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json",metastring:"lines",lines:!0},'[\n  {\n    "name": "nom d\'un champ de type fichier",\n    "headers": {\n      "Content-Type": "image/png", // Type MIME correspondant au fichier\n      // ...\n    },\n    "length": 128000, // Taille du fichier (en octets)\n    "contentType": "image/png", // Raccourci pour acc\xe9der \xe0 l\'en-t\xeate "Content-Type" du fichier\n    "contentDisposition": "form-data; name=\\"fieldName\\"; filename=\\"filename.png\\"", // Raccourci pour acc\xe9der \xe0 l\'en-t\xeate "Content-Disposition" du fichier\n    "fileName": "filename.png" // Nom de fichier, extrait du "Content-Disposition"\n  },\n  {\n    "name": "nom d\'un champ classique",\n    "value": "valeur du champ classique" // Toujours de type string\n  },\n  // ...\n]\n')),(0,a.kt)("p",null,"Pour acc\xe9der au contenu du fichier, il faut r\xe9cup\xe9rer un param\xe8tre de proc\xe9dure dont le nom r\xe9pond au format\n",(0,a.kt)("inlineCode",{parentName:"p"},"request_form_file_<nomDuChamp>")," et de type VARBINARY."),(0,a.kt)("p",null,"Exemple : nous allons r\xe9cup\xe9rer un formulaire permettant d'enregistrer un album de musique, avec la photo de sa couverture."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- #Route(\"/api/sampleForm\")\n-- #HttpPost(\"sampleForm\")\nCREATE OR ALTER PROCEDURE [web].[p_sample_form] \n    @request_form NVARCHAR(MAX), -- Les informations saisies par l'utilisateur seront stock\xe9es ici\n    @request_form_file_cover VARBINARY(MAX) -- Nous r\xe9cup\xe9rons la couverture au format binaire, tel qu'envoy\xe9 par l'utilisateur\nAS \nBEGIN\n    DECLARE @form_data TABLE (\n         [name] NVARCHAR(500)\n        ,[value] NVARCHAR(500)\n        ,[file_name] NVARCHAR(500)\n        ,[length] BIGINT\n    );\n    \n    INSERT INTO @form_data\n    SELECT \n         [name]\n        ,[value]\n        ,[fileName] AS [file_name]\n        ,[length]\n    FROM OPENJSON(@request_form)\n    WITH (\n         [name] NVARCHAR(500)\n        ,[value] NVARCHAR(500)\n        ,[fileName] NVARCHAR(500)\n        ,[length] BIGINT\n    );\n    \n    DECLARE @artist NVARCHAR(1000);\n    DECLARE @title NVARCHAR(1000);\n    DECLARE @cover_file_name NVARCHAR(1000);\n    DECLARE @cover_length BIGINT;\n    \n    SELECT TOP 1 @artist = [value] FROM @form_data\n    WHERE [name] = 'artist';\n    \n    SELECT TOP 1 @title = [value] FROM @form_data\n    WHERE [name] = 'title';\n    \n    SELECT TOP 1 \n         @cover_file_name = [file_name] \n        ,@cover_length = [length] / 1000 -- Obtention du r\xe9sultat en ko \n    FROM @form_data\n    WHERE [name] = 'cover';\n    \n    -- On v\xe9rifie le poids de l'image\n    IF (@cover_length > 500)\n    BEGIN\n        SELECT\n             '{ \"message\": \"Le poids de l''image que vous avez fourni doit \xeatre inf\xe9rieur \xe0 500ko\" }' AS [response_body]\n            ,'application/json' AS [response_content_type] \n            ,413 AS [response_status] -- 413 = Payload Too Large\n        ;\n    END\n\n    INSERT INTO [dbo].[albums] ([artist], [title], [cover], [cover_file_name])\n    VALUES (\n         @artist\n        ,@title\n        ,@request_form_file_cover\n        ,@cover_file_name\n    );\n    \n    SELECT \n        204 AS [response_status]\n    ;\nEND\nGO\n")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Pensez \xe0 bien v\xe9rifier le poids des fichiers que vous archivez.",(0,a.kt)("br",null),"\nLe transfert de gros fichiers ",(0,a.kt)("strong",{parentName:"p"},"n'est pas")," garanti.")),(0,a.kt)("h2",{id:"t\xe9l\xe9chargement-de-fichiers"},"T\xe9l\xe9chargement de fichiers"),(0,a.kt)("p",null,"Afin de transmettre des fichiers \xe0 l'utilisateur, SQListe met \xe0 votre disposition 3 param\xe8tres de sortie :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"response_file")," : permet de d\xe9finir le contenu du fichier retourn\xe9 (type ",(0,a.kt)("em",{parentName:"li"},"VARBINARY"),")"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"response_file_name")," : indique le nom du fichier (type NVARCHAR)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"response_file_inline")," : ",(0,a.kt)("em",{parentName:"li"},"BIT")," permettant d'ouvrir le fichier la visionneuse du navigateur (si disponible, sinon t\xe9l\xe9charge directement). Faux par d\xe9faut. ")),(0,a.kt)("p",null,"Exemple : "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- #Route(\"/api/sampleFileDownload\")\n-- #HttpPost(\"sampleFileDownload\")\nCREATE OR ALTER PROCEDURE [web].[p_sample_file_download] \nAS \nBEGIN\n    DECLARE @file VARBINARY(MAX);\n    DECLARE @file_name NVARCHAR(255);\n    DECLARE @file_mime NVARCHAR(255);\n    DECLARE @file_inline BIT = 0;\n    \n    -- R\xe9cup\xe9ration du fichier et de ses informations\n    -- ...\n\n    -- Si c'est un PDF, demande l'affichage pr\xe9alable dans le navigateur, sinon t\xe9l\xe9charge directement\n    IF (@file_mime = 'application/pdf')\n        SET @file_inline = 1;\n\n    SELECT \n         @file AS [response_file]\n        ,@file_name AS [response_file_name]\n        ,@file_inline AS [response_file_inline]\n        ,@file_mime AS [response_content_type]\n        ,200 AS [response_status]\n    ;\nEND\nGO\n")))}d.isMDXComponent=!0}}]);